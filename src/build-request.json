{
  "kind": "build_request",
  "title": "Insert historical production data for date 2026-02-21 and update master order status",
  "priority": "normal",
  "requirements": [
    {
      "id": "REQ-127",
      "text": "Create backend mutation function batchUpdateDailyProductionReport in backend/main.mo that accepts date (Text in YYYY-MM-DD format), an array of operation data objects containing operation_name, today_production, total_completed, and dispatched, auto-calculates in_hand (total_completed - dispatched) for each entry, checks if a Daily_Production_Report record exists for the given date + operation_name combination, performs UPDATE if record exists or INSERT if not exists, includes requireAdmin() authorization check, and returns a success confirmation with the count of entries processed",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-user-batch-request"
        ],
        "quotes": [
          "Create or update Daily_Production_Report entries for date 21.02.2026",
          "If record exists for date + operation → UPDATE, If not exists → INSERT",
          "Store date in database as: 2026-02-21 (YYYY-MM-DD format)"
        ]
      },
      "acceptanceCriteria": [
        "Function accepts date parameter in YYYY-MM-DD format",
        "Function accepts array of operation data with operation_name, today_production, total_completed, dispatched fields",
        "Function auto-calculates in_hand = total_completed - dispatched for each entry",
        "Function checks existence of Daily_Production_Report entry by date + operation_name",
        "Function updates existing entries or inserts new entries as appropriate",
        "Function includes requireAdmin() authorization check",
        "Function returns success confirmation with count of processed entries"
      ]
    },
    {
      "id": "REQ-128",
      "text": "Execute batch insertion for date 2026-02-21 with all 17 operations using the exact production data: Boxing (today=5, total=400, dispatch=344), Welding/Finishing (today=4, total=399, dispatch=344), Rear Wall (today=2, total=403, dispatch=344), Front Wall (today=5, total=422, dispatch=344), Side Wall (today=8, total=439, dispatch=344), Roof (today=0, total=427, dispatch=344), Rear Door (today=10, total=420, dispatch=344), Blasting & Primer (today=4, total=367, dispatch=344), Final Paint (today=3, total=359, dispatch=344), Gasket (today=5, total=352, dispatch=344), DLM (today=5, total=352, dispatch=344), Plywood (today=5, total=351, dispatch=344), Floor Screw (today=5, total=350, dispatch=344), Decal (today=5, total=352, dispatch=344), Data Plate (today=5, total=352, dispatch=344), Sikha (today=4, total=346, dispatch=344), Black Paint (today=1, total=345, dispatch=344), storing date as '2026-02-21' in YYYY-MM-DD format with auto-calculated in_hand values",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-user-batch-request"
        ],
        "quotes": [
          "Data: Boxing → today=5, total=400, dispatch=344",
          "Store date in database as: 2026-02-21 (YYYY-MM-DD format)",
          "Auto calculate: in_hand = total - dispatch"
        ]
      },
      "acceptanceCriteria": [
        "All 17 operation entries are created/updated for date 2026-02-21",
        "Date is stored as '2026-02-21' in YYYY-MM-DD format",
        "Each entry has correct today_production, total_completed, and dispatched values as specified",
        "in_hand is auto-calculated for each entry as total_completed - dispatched",
        "All entries are persisted to stable storage"
      ]
    },
    {
      "id": "REQ-129",
      "text": "Update Master_Order_Status entry after batch data insertion with values: total_order_quantity=600, total_manufactured=345, total_dispatched=344, ensuring backend calculation shows remaining_to_produce=255 (600-345), finished_stock=1 (345-344), and completion_percentage=57.5 ((345/600)*100)",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-user-batch-request"
        ],
        "quotes": [
          "After saving: Update Master_Order_Status: total_order_quantity = 600, total_manufactured = 345, total_dispatched = 344, remaining_to_produce = 255, finished_stock = 1, completion_percentage = 57.5"
        ]
      },
      "acceptanceCriteria": [
        "Master_Order_Status entry is updated with total_order_quantity=600",
        "total_manufactured is set to 345",
        "total_dispatched is set to 344",
        "Backend correctly calculates remaining_to_produce as 255",
        "Backend correctly calculates finished_stock as 1",
        "Backend correctly calculates completion_percentage as 57.5"
      ]
    },
    {
      "id": "REQ-130",
      "text": "Ensure ProductionDashboardLivePage at frontend/src/pages/ProductionDashboardLivePage.tsx automatically refreshes and displays the updated production data for date 2026-02-21 after batch insertion completes, showing new today's production totals in summary cards, updated monthly summaries, refreshed production trend chart including the new date data point, and updated master order progress metrics with total_manufactured=345 and total_dispatched=344",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-user-batch-request"
        ],
        "quotes": [
          "Ensure dashboard allows viewing data for selected historical date 2026-02-21"
        ]
      },
      "acceptanceCriteria": [
        "Dashboard automatically refreshes after batch data insertion",
        "Summary cards display updated today's production totals for 2026-02-21",
        "Monthly production summaries reflect the new data",
        "Production trend chart includes the new data point for 2026-02-21",
        "Master order progress section shows total_manufactured=345 and total_dispatched=344",
        "All calculated metrics (remaining, finished stock, completion %) are correct"
      ]
    },
    {
      "id": "REQ-131",
      "text": "Ensure LiveProductionTable component at frontend/src/components/LiveProductionTable.tsx correctly displays all 17 operations with production data when date 2026-02-21 is selected, showing each operation's today_production, total_completed, dispatched, and auto-calculated in_hand values in table rows",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-user-batch-request"
        ],
        "quotes": [
          "Ensure dashboard allows viewing data for selected historical date 2026-02-21"
        ]
      },
      "acceptanceCriteria": [
        "Table displays all 17 operations for date 2026-02-21",
        "Each operation shows correct today_production value",
        "Each operation shows correct total_completed value",
        "Each operation shows correct dispatched value",
        "in_hand is correctly calculated and displayed as (total_completed - dispatched)",
        "Table loads without errors when 2026-02-21 is selected"
      ]
    }
  ],
  "constraints": [
    "Do not modify frontend/src/hooks/useInternetIdentity.ts or frontend/src/hooks/useInternetIdentity.tsx",
    "Do not modify frontend/src/hooks/useActor.ts",
    "Do not modify frontend/src/main.tsx",
    "Do not modify frontend/src/components/ui directory",
    "Maintain single-actor architecture in backend/main.mo",
    "Use stable storage for all data persistence",
    "Date must be stored in YYYY-MM-DD format (2026-02-21)"
  ],
  "nonGoals": [
    "Modifying the date format display in the UI",
    "Adding new operations beyond the existing 17",
    "Changing the master order total quantity target",
    "Implementing data export functionality",
    "Adding user notifications or alerts"
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}